## Block/Block Cache  
Block是sstable的基本存储单温；Block Cache用来缓存Block，可以加速读操作和Compaction速度

- blockr_ size  
一般设置为32k、64k，调大可以减小空间放大，但是不利于缓存命中，增加读放大

- block_cache_size  
根据实际的内存容量来设，建议总的block cache空间占内存的1/4到1/3，调大该值对该CF的读性能有明显提升

- 压缩算法
  - compression控制前面n-1层的压缩方式，推荐使用LZ4(kLZ4Compression)，其次是Snappy（kSnappyCompression）
  - bottonmost_compression控制第n层的压缩方式，推荐使用ZStand(kZSTD)，其次是Zlib（kZlibCompression）
  - compression_per_level逐层配置压缩法(设置了该项则commpression不再有效)，例如可以L0、L1配置为不压缩(kNoCompression)
  - BlockBasedTableOptions.enable_index_compression设置为false来关闭索引的压缩(因为指定的压缩方式总是同时应用在索引和数据块)

```
  https://smalldatum.blogspot.com/2018/08/name-that-compaction-algorithm.html
  压缩算法：经典Leveled，Tiered，Tiered+Leveled，Leveled-N,FIFO。
```

- 导入SST
  - rocksdb::SstFileWriter可以用于创建SST文件，成功创建后，可以打开，插入若干行数据，然后结束
  - 导入SST文件非常简单，调用DB::IngestExternalFile()然后把文件地址（std::string）放入vector传入就行
    - 把文件拷贝，或者链接到DB的目录
    - 阻塞DB的写入，因为必须要保证db状态的一致性(确保将导入的文件里的所有key都分配正确的序列号)
    - 如果文件的key覆盖了memtable的键范围，把memtable刷盘
    - 把文件安排到LSM树的最好的层(满足条件的最低的层)
       - 文件可以安排在这个层
       - 这个文件的key的范围不会覆盖上面任何一层的数据
       - 这个文件的key的范围不会覆盖当前层正在进行压缩
    - 给文件赋值一个全局序列号
    - 重启DB的写入
