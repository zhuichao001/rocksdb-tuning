#### Compaction  
- compaction_style  
默认Leveld Compaction (实际是Leveld+Tiered Compaction)

- level_compaction_dynamic_level_bytes  
该参数打开后，保持LSM树的正三角形形态，逐层的阈值大小会动态调整，可以减少写放大

- level0_file_num_compaction_trigger  
Level0文件数达到该值时，启动压缩，默认为4

- Compaction的触发条件  
  - switch wal：当 WAL 的文件大小超过阈值(DBOptions::max_total_wal_size)时, 触发Flush  
  - writer buffer full：当 memtable 写满时, 触发Flush  
  - schedule compaction  
    - 手工compaction  
    - Ln-1的大小达到阈值的上限  
    - Ln-1的查找Miss达到上限  

- 限速  
限制压缩和写盘的速度以避免异常读延迟，可以通过设置db_options.rate_limiter选项来达到目的。  
  ```
  RateLimiter* rate_limiter = NewGenericRateLimiter(
      rate_bytes_per_sec , 
      refill_period_us ,
      fairness );
  ```
- Compaction Filter  
用户可以自己实现CompactionFilter接口，以便根据某些特定条件在Compaction的时候快速回收KV

- 降低写放大  
Compaction 过程中选择文件的优先级，能够降低写放大
```
// 优先选择和下一层SST文件覆盖度较低的文件进行Compaction，减少Compaction过程中被反复读出写入
cf_options.compaction_pri = kMinOverlappingRatio;
```
